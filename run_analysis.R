# 1. Merges the training and the test sets to create one data set.

# Read train and test files

setwd("/Users/donttouch/Coursera/GettingAndCleaningData/FinalAss/UCI HAR Dataset")

# Read train and test Subject files

File_TrainSubject = "./train/subject_train.txt"
File_TestSubject = "./test/subject_test.txt"

TrainSubject <- read.table(File_TrainSubject)
TestSubject <- read.table(File_TestSubject)

# Read train and test Labels files

# Activity Labels
# 1 WALKING
# 2 WALKING_UPSTAIRS
# 3 WALKING_DOWNSTAIRS
# 4 SITTING
# 5 STANDING
# 6 LAYING

File_TrainLabels = "./train/y_train.txt"
File_TestLabels = "./test/y_test.txt"

TrainLabels <- read.table(File_TrainLabels)
TestLabels <- read.table(File_TestLabels)

# Read train and test Sets files

File_TrainSets = "./train/X_train.txt"
File_TestSets = "./test/X_test.txt"

TrainSets<- read.table(File_TrainSets)
TestSets <- read.table(File_TestSets)

# Merge Subject,Labels and Sets files

TotalSubject = rbind(TrainSubject,TestSubject)
TotalLabels = rbind(TrainLabels,TestLabels)
TotalSets = rbind(TrainSets,TestSets)

# Set columns names for Subject and Labels data tables

names(TotalSubject) <- c("subject")
names(TotalLabels) <- c("activitynumber")

# Read and set column names  for activity_labels file

File_ActivityLabels = "activity_labels.txt"
ActivityLabelsDataFile <- read.table(File_ActivityLabels)
names(ActivityLabelsDataFile)<-c("activitynumber","activityname")

# Read features file and sets columns names

File_Features = "features.txt"
FeaturesDataFile <- read.table(File_Features)
names(FeaturesDataFile)<-c("featurenumber","featurename")

# Set TotalSets column names using FeaturesDataFile

ColumnNames<-FeaturesDataFile[,"featurename"]	
names(TotalSets)<-ColumnNames

# Merge data columns
SubjectActivityData <- cbind(TotalSubject,TotalLabels)
SubjectData <- cbind(SubjectActivityData, TotalSets)

# 2. Extracts only the measurements on the mean and standard deviation for each measurement.

SubjectDataSubset1 <-SubjectData[1:2]
SubjectDataSubset2 <-SubjectData[grepl("mean\\(\\)|std\\(\\)",names(SubjectData))]

SubjectData <- cbind(SubjectDataSubset1,SubjectDataSubset2)

# 3. Use descriptive activity names to name the activities in the data set.

SubjectData <-merge(ActivityLabelsDataFile,SubjectData, by="activitynumber",all.x=TRUE)

#Order and sort by columns "subject", "activityname", ..
library(dplyr)
SubjectData <- SubjectData[c(3,2,1,4:ncol(SubjectData))]
SubjectData <- arrange(SubjectData,subject,activityname)
SubjectData$activityname <- as.character(SubjectData$activityname)

# 4. Appriopriately labels the data set with descriptive variable names.

# Variables names before 
str(SubjectData)
#'data.frame':	10299 obs. of  69 variables:
# $ subject                    : int  1 1 1 1 1 1 1 1 1 1 ...
# $ activityname               : chr  "LAYING" "LAYING" "LAYING" "LAYING" ...
# $ activitynumber             : int  6 6 6 6 6 6 6 6 6 6 ...
# $ tBodyAcc-mean()-X          : num  0.278 0.279 0.278 0.276 0.277 ...
# $ tBodyAcc-mean()-Y          : num  -0.0171 -0.0176 -0.0177 -0.0162 -0.0172 ...
# $ tBodyAcc-mean()-Z          : num  -0.108 -0.108 -0.106 -0.109 -0.106 ...
# $ tBodyAcc-std()-X           : num  -0.995 -0.995 -0.996 -0.996 -0.995 ...
# $ tBodyAcc-std()-Y           : num  -0.998 -0.996 -0.996 -0.996 -0.991 ...
# $ tBodyAcc-std()-Z           : num  -0.992 -0.994 -0.995 -0.994 -0.993 ...
# $ tGravityAcc-mean()-X       : num  -0.209 -0.207 -0.207 -0.206 -0.206 ...
# $ tGravityAcc-mean()-Y       : num  0.771 0.769 0.77 0.769 0.769 ...
# $ tGravityAcc-mean()-Z       : num  0.589 0.593 0.592 0.592 0.591 ...
# $ tGravityAcc-std()-X        : num  -1 -0.999 -0.999 -0.998 -0.998 ...
# $ tGravityAcc-std()-Y        : num  -0.999 -0.998 -0.998 -0.997 -0.997 ...
# $ tGravityAcc-std()-Z        : num  -0.997 -0.995 -0.996 -0.997 -0.993 ...
# $ tBodyAccJerk-mean()-X      : num  0.0756 0.0726 0.0745 0.0792 0.078 ...
# $ tBodyAccJerk-mean()-Y      : num  0.01234 0.01028 0.01542 0.01387 0.00854 ...
# $ tBodyAccJerk-mean()-Z      : num  0.0014 -0.00264 0.00492 0.0021 -0.0053 ...
# $ tBodyAccJerk-std()-X       : num  -0.992 -0.991 -0.993 -0.993 -0.992 ...
# $ tBodyAccJerk-std()-Y       : num  -0.993 -0.994 -0.994 -0.993 -0.986 ...
# $ tBodyAccJerk-std()-Z       : num  -0.992 -0.993 -0.993 -0.993 -0.993 ...
# $ tBodyGyro-mean()-X         : num  -0.0304 -0.0279 -0.0282 -0.0276 -0.0274 ...
# $ tBodyGyro-mean()-Y         : num  -0.0735 -0.0757 -0.0759 -0.0747 -0.0762 ...
# $ tBodyGyro-mean()-Z         : num  0.0556 0.0862 0.0852 0.0876 0.0882 ...
# $ tBodyGyro-std()-X          : num  -0.999 -0.999 -0.998 -0.999 -1 ...
# $ tBodyGyro-std()-Y          : num  -0.995 -0.994 -0.995 -0.995 -0.996 ...
# $ tBodyGyro-std()-Z          : num  -0.994 -0.993 -0.994 -0.995 -0.994 ...
# $ tBodyGyroJerk-mean()-X     : num  -0.0982 -0.0978 -0.0988 -0.0987 -0.0979 ...
# $ tBodyGyroJerk-mean()-Y     : num  -0.0412 -0.0415 -0.043 -0.0401 -0.0414 ...
# $ tBodyGyroJerk-mean()-Z     : num  -0.0461 -0.0542 -0.0556 -0.055 -0.0518 ...
# $ tBodyGyroJerk-std()-X      : num  -0.999 -0.999 -0.997 -0.998 -1 ...
# $ tBodyGyroJerk-std()-Y      : num  -0.998 -0.998 -0.998 -0.998 -0.999 ...
# $ tBodyGyroJerk-std()-Z      : num  -0.997 -0.996 -0.997 -0.997 -0.996 ...
# $ tBodyAccMag-mean()         : num  -0.997 -0.997 -0.998 -0.998 -0.996 ...
# $ tBodyAccMag-std()          : num  -0.996 -0.999 -0.999 -0.997 -0.996 ...
# $ tGravityAccMag-mean()      : num  -0.997 -0.997 -0.998 -0.998 -0.996 ...
# $ tGravityAccMag-std()       : num  -0.996 -0.999 -0.999 -0.997 -0.996 ...
# $ tBodyAccJerkMag-mean()     : num  -0.994 -0.994 -0.994 -0.993 -0.991 ...
# $ tBodyAccJerkMag-std()      : num  -0.993 -0.994 -0.997 -0.996 -0.996 ...
# $ tBodyGyroMag-mean()        : num  -0.988 -0.996 -0.996 -0.997 -0.997 ...
# $ tBodyGyroMag-std()         : num  -0.996 -0.997 -0.998 -0.999 -0.999 ...
# $ tBodyGyroJerkMag-mean()    : num  -0.999 -0.998 -0.999 -0.999 -0.999 ...
# $ tBodyGyroJerkMag-std()     : num  -0.999 -0.999 -0.999 -0.999 -0.999 ...
# $ fBodyAcc-mean()-X          : num  -0.995 -0.994 -0.995 -0.995 -0.993 ...
# $ fBodyAcc-mean()-Y          : num  -0.996 -0.994 -0.994 -0.994 -0.989 ...
# $ fBodyAcc-mean()-Z          : num  -0.992 -0.994 -0.994 -0.992 -0.992 ...
# $ fBodyAcc-std()-X           : num  -0.995 -0.996 -0.997 -0.996 -0.996 ...
# $ fBodyAcc-std()-Y           : num  -0.999 -0.996 -0.996 -0.996 -0.992 ...
# $ fBodyAcc-std()-Z           : num  -0.992 -0.994 -0.995 -0.995 -0.993 ...
# $ fBodyAccJerk-mean()-X      : num  -0.993 -0.991 -0.993 -0.993 -0.992 ...
# $ fBodyAccJerk-mean()-Y      : num  -0.993 -0.994 -0.994 -0.993 -0.987 ...
# $ fBodyAccJerk-mean()-Z      : num  -0.991 -0.992 -0.991 -0.99 -0.991 ...
# $ fBodyAccJerk-std()-X       : num  -0.992 -0.993 -0.994 -0.993 -0.994 ...
# $ fBodyAccJerk-std()-Y       : num  -0.993 -0.995 -0.995 -0.993 -0.987 ...
# $ fBodyAccJerk-std()-Z       : num  -0.991 -0.993 -0.994 -0.994 -0.993 ...
# $ fBodyGyro-mean()-X         : num  -0.999 -0.999 -0.997 -0.998 -1 ...
# $ fBodyGyro-mean()-Y         : num  -0.996 -0.996 -0.996 -0.996 -0.997 ...
# $ fBodyGyro-mean()-Z         : num  -0.992 -0.995 -0.995 -0.996 -0.994 ...
# $ fBodyGyro-std()-X          : num  -0.999 -0.999 -0.999 -0.999 -1 ...
# $ fBodyGyro-std()-Y          : num  -0.994 -0.993 -0.994 -0.994 -0.995 ...
# $ fBodyGyro-std()-Z          : num  -0.996 -0.993 -0.994 -0.995 -0.995 ...
# $ fBodyAccMag-mean()         : num  -0.995 -0.998 -0.998 -0.996 -0.994 ...
# $ fBodyAccMag-std()          : num  -0.997 -0.999 -0.999 -0.997 -0.997 ...
# $ fBodyBodyAccJerkMag-mean() : num  -0.993 -0.993 -0.996 -0.996 -0.996 ...
# $ fBodyBodyAccJerkMag-std()  : num  -0.992 -0.996 -0.997 -0.994 -0.994 ...
# $ fBodyBodyGyroMag-mean()    : num  -0.997 -0.998 -0.998 -0.999 -0.999 ...
# $ fBodyBodyGyroMag-std()     : num  -0.996 -0.997 -0.998 -0.999 -0.999 ...
# $ fBodyBodyGyroJerkMag-mean(): num  -0.999 -0.999 -0.998 -0.999 -0.999 ...
# $ fBodyBodyGyroJerkMag-std() : num  -0.999 -0.998 -0.999 -0.998 -0.999 ...


# Gyro - gyroscopic measurements
# Acc - accelerometer measurements
# f and t - indicate frequency and time domain signal
# mean() and std() - for each subject for each activity measurements
#     Standard gravity units 'g'/s for accelerometer, radians/second for gyroscope 
      and jerk ?rad/sec?
# Jerk - the body linear acceleration and angular velocity
# Gravity - gravity acceleration signals
# Body - body motion components
# Mag - magnitude

names(SubjectData)<-gsub("^t", "time", names(SubjectData))
names(SubjectData)<-gsub("^f", "frequency", names(SubjectData))
names(SubjectData)<-gsub("Acc", "Accelerometer", names(SubjectData))
names(SubjectData)<-gsub("Gyro", "Gyroscope", names(SubjectData))
names(SubjectData)<-gsub("Mag", "Magnitude", names(SubjectData))
names(SubjectData)<-gsub("BodyBody", "Body", names(SubjectData))
names(SubjectData)<-gsub("mean()", "MEAN", names(SubjectData))
names(SubjectData)<-gsub("std()", "SD", names(SubjectData))

str(SubjectData)
#'data.frame':	10299 obs. of  69 variables:
# $ subject                                       : int  1 1 1 1 1 1 1 1 1 1 ...
# $ activityname                                  : chr  "LAYING" "LAYING" "LAYING" "LAYING" ...
# $ activitynumber                                : int  6 6 6 6 6 6 6 6 6 6 ...
# $ timeBodyAccelerometer-MEAN()-X                : num  0.278 0.279 0.278 0.276 0.277 ...
# $ timeBodyAccelerometer-MEAN()-Y                : num  -0.0171 -0.0176 -0.0177 -0.0162 -0.0172 ...
# $ timeBodyAccelerometer-MEAN()-Z                : num  -0.108 -0.108 -0.106 -0.109 -0.106 ...
# $ timeBodyAccelerometer-SD()-X                  : num  -0.995 -0.995 -0.996 -0.996 -0.995 ...
# $ timeBodyAccelerometer-SD()-Y                  : num  -0.998 -0.996 -0.996 -0.996 -0.991 ...
# $ timeBodyAccelerometer-SD()-Z                  : num  -0.992 -0.994 -0.995 -0.994 -0.993 ...
# $ timeGravityAccelerometer-MEAN()-X             : num  -0.209 -0.207 -0.207 -0.206 -0.206 ...
# $ timeGravityAccelerometer-MEAN()-Y             : num  0.771 0.769 0.77 0.769 0.769 ...
# $ timeGravityAccelerometer-MEAN()-Z             : num  0.589 0.593 0.592 0.592 0.591 ...
# $ timeGravityAccelerometer-SD()-X               : num  -1 -0.999 -0.999 -0.998 -0.998 ...
# $ timeGravityAccelerometer-SD()-Y               : num  -0.999 -0.998 -0.998 -0.997 -0.997 ...
# $ timeGravityAccelerometer-SD()-Z               : num  -0.997 -0.995 -0.996 -0.997 -0.993 ...
# $ timeBodyAccelerometerJerk-MEAN()-X            : num  0.0756 0.0726 0.0745 0.0792 0.078 ...
# $ timeBodyAccelerometerJerk-MEAN()-Y            : num  0.01234 0.01028 0.01542 0.01387 0.00854 ...
# $ timeBodyAccelerometerJerk-MEAN()-Z            : num  0.0014 -0.00264 0.00492 0.0021 -0.0053 ...
# $ timeBodyAccelerometerJerk-SD()-X              : num  -0.992 -0.991 -0.993 -0.993 -0.992 ...
# $ timeBodyAccelerometerJerk-SD()-Y              : num  -0.993 -0.994 -0.994 -0.993 -0.986 ...
# $ timeBodyAccelerometerJerk-SD()-Z              : num  -0.992 -0.993 -0.993 -0.993 -0.993 ...
# $ timeBodyGyroscope-MEAN()-X                    : num  -0.0304 -0.0279 -0.0282 -0.0276 -0.0274 ...
# $ timeBodyGyroscope-MEAN()-Y                    : num  -0.0735 -0.0757 -0.0759 -0.0747 -0.0762 ...
# $ timeBodyGyroscope-MEAN()-Z                    : num  0.0556 0.0862 0.0852 0.0876 0.0882 ...
# $ timeBodyGyroscope-SD()-X                      : num  -0.999 -0.999 -0.998 -0.999 -1 ...
# $ timeBodyGyroscope-SD()-Y                      : num  -0.995 -0.994 -0.995 -0.995 -0.996 ...
# $ timeBodyGyroscope-SD()-Z                      : num  -0.994 -0.993 -0.994 -0.995 -0.994 ...
# $ timeBodyGyroscopeJerk-MEAN()-X                : num  -0.0982 -0.0978 -0.0988 -0.0987 -0.0979 ...
# $ timeBodyGyroscopeJerk-MEAN()-Y                : num  -0.0412 -0.0415 -0.043 -0.0401 -0.0414 ...
# $ timeBodyGyroscopeJerk-MEAN()-Z                : num  -0.0461 -0.0542 -0.0556 -0.055 -0.0518 ...
# $ timeBodyGyroscopeJerk-SD()-X                  : num  -0.999 -0.999 -0.997 -0.998 -1 ...
# $ timeBodyGyroscopeJerk-SD()-Y                  : num  -0.998 -0.998 -0.998 -0.998 -0.999 ...
# $ timeBodyGyroscopeJerk-SD()-Z                  : num  -0.997 -0.996 -0.997 -0.997 -0.996 ...
# $ timeBodyAccelerometerMagnitude-MEAN()         : num  -0.997 -0.997 -0.998 -0.998 -0.996 ...
# $ timeBodyAccelerometerMagnitude-SD()           : num  -0.996 -0.999 -0.999 -0.997 -0.996 ...
# $ timeGravityAccelerometerMagnitude-MEAN()      : num  -0.997 -0.997 -0.998 -0.998 -0.996 ...
# $ timeGravityAccelerometerMagnitude-SD()        : num  -0.996 -0.999 -0.999 -0.997 -0.996 ...
# $ timeBodyAccelerometerJerkMagnitude-MEAN()     : num  -0.994 -0.994 -0.994 -0.993 -0.991 ...
# $ timeBodyAccelerometerJerkMagnitude-SD()       : num  -0.993 -0.994 -0.997 -0.996 -0.996 ...
# $ timeBodyGyroscopeMagnitude-MEAN()             : num  -0.988 -0.996 -0.996 -0.997 -0.997 ...
# $ timeBodyGyroscopeMagnitude-SD()               : num  -0.996 -0.997 -0.998 -0.999 -0.999 ...
# $ timeBodyGyroscopeJerkMagnitude-MEAN()         : num  -0.999 -0.998 -0.999 -0.999 -0.999 ...
# $ timeBodyGyroscopeJerkMagnitude-SD()           : num  -0.999 -0.999 -0.999 -0.999 -0.999 ...
# $ frequencyBodyAccelerometer-MEAN()-X           : num  -0.995 -0.994 -0.995 -0.995 -0.993 ...
# $ frequencyBodyAccelerometer-MEAN()-Y           : num  -0.996 -0.994 -0.994 -0.994 -0.989 ...
# $ frequencyBodyAccelerometer-MEAN()-Z           : num  -0.992 -0.994 -0.994 -0.992 -0.992 ...
# $ frequencyBodyAccelerometer-SD()-X             : num  -0.995 -0.996 -0.997 -0.996 -0.996 ...
# $ frequencyBodyAccelerometer-SD()-Y             : num  -0.999 -0.996 -0.996 -0.996 -0.992 ...
# $ frequencyBodyAccelerometer-SD()-Z             : num  -0.992 -0.994 -0.995 -0.995 -0.993 ...
# $ frequencyBodyAccelerometerJerk-MEAN()-X       : num  -0.993 -0.991 -0.993 -0.993 -0.992 ...
# $ frequencyBodyAccelerometerJerk-MEAN()-Y       : num  -0.993 -0.994 -0.994 -0.993 -0.987 ...
# $ frequencyBodyAccelerometerJerk-MEAN()-Z       : num  -0.991 -0.992 -0.991 -0.99 -0.991 ...
# $ frequencyBodyAccelerometerJerk-SD()-X         : num  -0.992 -0.993 -0.994 -0.993 -0.994 ...
# $ frequencyBodyAccelerometerJerk-SD()-Y         : num  -0.993 -0.995 -0.995 -0.993 -0.987 ...
# $ frequencyBodyAccelerometerJerk-SD()-Z         : num  -0.991 -0.993 -0.994 -0.994 -0.993 ...
# $ frequencyBodyGyroscope-MEAN()-X               : num  -0.999 -0.999 -0.997 -0.998 -1 ...
# $ frequencyBodyGyroscope-MEAN()-Y               : num  -0.996 -0.996 -0.996 -0.996 -0.997 ...
# $ frequencyBodyGyroscope-MEAN()-Z               : num  -0.992 -0.995 -0.995 -0.996 -0.994 ...
# $ frequencyBodyGyroscope-SD()-X                 : num  -0.999 -0.999 -0.999 -0.999 -1 ...
# $ frequencyBodyGyroscope-SD()-Y                 : num  -0.994 -0.993 -0.994 -0.994 -0.995 ...
# $ frequencyBodyGyroscope-SD()-Z                 : num  -0.996 -0.993 -0.994 -0.995 -0.995 ...
# $ frequencyBodyAccelerometerMagnitude-MEAN()    : num  -0.995 -0.998 -0.998 -0.996 -0.994 ...
# $ frequencyBodyAccelerometerMagnitude-SD()      : num  -0.997 -0.999 -0.999 -0.997 -0.997 ...
# $ frequencyBodyAccelerometerJerkMagnitude-MEAN(): num  -0.993 -0.993 -0.996 -0.996 -0.996 ...
# $ frequencyBodyAccelerometerJerkMagnitude-SD()  : num  -0.992 -0.996 -0.997 -0.994 -0.994 ...
# $ frequencyBodyGyroscopeMagnitude-MEAN()        : num  -0.997 -0.998 -0.998 -0.999 -0.999 ...
# $ frequencyBodyGyroscopeMagnitude-SD()          : num  -0.996 -0.997 -0.998 -0.999 -0.999 ...
# $ frequencyBodyGyroscopeJerkMagnitude-MEAN()    : num  -0.999 -0.999 -0.998 -0.999 -0.999 ...
# $ frequencyBodyGyroscopeJerkMagnitude-SD()      : num  -0.999 -0.998 -0.999 -0.998 -0.999 ..

# 5. From the data set in step 4, creates a second, independent tidy data set with the average of each variable for
# each activity and each subject.

SubjectDataAggr <- aggregate(. ~ subject - activityname, data=SubjectData , mean)

str(SubjectDataAggr)

#'data.frame':	180 obs. of  69 variables:
# $ subject                                       : int  1 2 3 4 5 6 7 8 9 10 ...
# $ activityname                                  : chr  "LAYING" "LAYING" "LAYING" "LAYING" ...
# $ activitynumber                                : num  6 6 6 6 6 6 6 6 6 6 ...
# $ timeBodyAccelerometer-MEAN()-X                : num  0.222 0.281 0.276 0.264 0.278 ...
# $ timeBodyAccelerometer-MEAN()-Y                : num  -0.0405 -0.0182 -0.019 -0.015 -0.0183 ...
# $ timeBodyAccelerometer-MEAN()-Z                : num  -0.113 -0.107 -0.101 -0.111 -0.108 ...
# $ timeBodyAccelerometer-SD()-X                  : num  -0.928 -0.974 -0.983 -0.954 -0.966 ...
# $ timeBodyAccelerometer-SD()-Y                  : num  -0.837 -0.98 -0.962 -0.942 -0.969 ...
# $ timeBodyAccelerometer-SD()-Z                  : num  -0.826 -0.984 -0.964 -0.963 -0.969 ...
# $ timeGravityAccelerometer-MEAN()-X             : num  -0.249 -0.51 -0.242 -0.421 -0.483 ...
# $ timeGravityAccelerometer-MEAN()-Y             : num  0.706 0.753 0.837 0.915 0.955 ...
# $ timeGravityAccelerometer-MEAN()-Z             : num  0.446 0.647 0.489 0.342 0.264 ...
...
# Sort by subject ans activity
SubjectData <- arrange(SubjectDataAggr,subject,activityname)
str(SubjectDataAggr)

#'data.frame':	180 obs. of  69 variables:
# $ subject                                       : int  1 2 3 4 5 6 7 8 9 10 ...
# $ activityname                                  : chr  "LAYING" "LAYING" "LAYING" "LAYING" ...
# $ activitynumber                                : num  6 6 6 6 6 6 6 6 6 6 ...
# $ timeBodyAccelerometer-MEAN()-X                : num  0.222 0.281 0.276 0.264 0.278 ...
# $ timeBodyAccelerometer-MEAN()-Y                : num  -0.0405 -0.0182 -0.019 -0.015 -0.0183 ...
# $ timeBodyAccelerometer-MEAN()-Z                : num  -0.113 -0.107 -0.101 -0.111 -0.108 ...
# $ timeBodyAccelerometer-SD()-X                  : num  -0.928 -0.974 -0.983 -0.954 -0.966 ...
# $ timeBodyAccelerometer-SD()-Y                  : num  -0.837 -0.98 -0.962 -0.942 -0.969 ...
# $ timeBodyAccelerometer-SD()-Z                  : num  -0.826 -0.984 -0.964 -0.963 -0.969 ...
# $ timeGravityAccelerometer-MEAN()-X             : num  -0.249 -0.51 -0.242 -0.421 -0.483 ...
# $ timeGravityAccelerometer-MEAN()-Y             : num  0.706 0.753 0.837 0.915 0.955 ...
# $ timeGravityAccelerometer-MEAN()-Z             : num  0.446 0.647 0.489 0.342 0.264 ...
...
## Write to a file

write.table(SubjectData,"tidydata.txt", row.names=FALSE)
